{% extends 'layouts/lessons.html' %}
{% load static %}
{% load custom_filters %}


{% block title %}
    {{ user_lesson.lesson.title }} | Аралас оқыту
{% endblock title %}


{% block course_content %}
<div class="w-full overflow-hidden bg-white" style="height: calc(100vh - 85px);">
    <div class="swiper lessonSwiper swiper-h w-full h-full">
        <!-- Theory block -->
        <div class="swiper-wrapper">
            <!-- Text contents -->
            {% if user_lesson.lesson.text_contents.all|length > 0 %}
                <div class="swiper-slide grid overflow-auto">
                    {% for item in user_lesson.lesson.text_contents.all %}
                        <div class="w-full h-full p-8 flex justify-center">
                            <div class="max-w-screen-xl w-full grid gap-4">
                                <h1 class="text-2xl font-semibold text-center">{{ item.title }}</h1>
                                <div class="text-gray-500 text-justify">
                                    {{ item.content|safe }}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            <!-- Video contents -->
            {% if user_lesson.lesson.video_contents.all|length > 0 %}
                <div class="swiper-slide overflow-auto">
                    {% for item in user_lesson.lesson.video_contents.all %}
                        <div class="relative h-full">
                            <iframe 
                                width="100%" 
                                height="100%" 
                                src="https://www.youtube.com/embed/{{ item.url|youtube_id }}" 
                                title="YouTube video player" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen
                                class="cursor-pointer"
                            >
                            </iframe>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            <!-- Frame contents -->
            {% if user_lesson.lesson.frame_contents.all|length > 0 %}
                <div class="swiper-slide">
                    {% for item in user_lesson.lesson.frame_contents.all %}
                        <div class="relative h-full">
                            {{ item.url|safe }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
    
    <!-- Initialize Swiper -->
    <script>
        var swiper = new Swiper(".lessonSwiper", {
            spaceBetween: 50,
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
        });
    </script>
</div>
{% endblock course_content %}